name: Sync Theme to Unofficial Repo

on:
  push:
    branches:
      - main
    paths:
      - 'themes/yun/**'

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
          
      - name: Push themes/yun to hexo-theme-yun-unofficial
        run: |
          cd themes/yun
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          
          # Initialize git if not already initialized
          if [ ! -d .git ]; then
            git init
            git add .
            git commit -m "Sync from main repository"
          fi
          
          # Add remote if not exists
          git remote remove origin 2>/dev/null || true
          git remote add origin https://x-access-token:${{ secrets.PAT_TOKEN }}@github.com/Bryan0324/hexo-theme-yun-unofficial.git
          
          # Push to main branch
          git branch -M main
          git push -u origin main --force
